* C:\Users\circuit\spice\saradc.asc
C1 N002 N011 320f
S1 N011 N012 SW5 0 SW
S2 N011 0 SW5B 0 SW
C2 N002 N010 160f
S3 N010 N012 SW4 0 SW
S4 N010 0 SW4B 0 SW
C3 N002 N009 80f
S5 N009 N012 SW3 0 SW
S6 N009 0 SW3B 0 SW
C4 N002 N008 40f
S7 N008 N012 SW2 0 SW
S8 N008 0 SW2B 0 SW
C5 N002 N007 20f
S9 N007 N012 SW1 0 SW
S10 N007 0 SW1B 0 SW
C6 N002 N006 10f
S11 N006 N012 SW0 0 SW
S12 N006 0 SW0B 0 SW
C7 N002 N005 10f
S13 N005 N012 Sample 0 SW
S14 N005 0 COMP_ENB 0 SW
S15 N012 N013 COMP_ENB 0 SW
S16 N012 N014 Sample 0 SW
V1 CLK 0 PULSE(0 1 0 30p 30p 5.555n 11.11n)
V2 N013 0 1
V3 N014 0 PULSE(0 1 0 12.8u 0 0.2u 13u)
S17 0 N002 Sample 0 SW
A1 CLK COMP_EN 0 0 0 N004 0 0 OR
V5 N001 0 1.8
A2 COMP_EN 0 0 0 0 COMP_ENB 0 0 BUF
B1 DOUT 0 V=32*V(Q05)+16*V(Q04)+8*V(Q03)+4*V(Q02)+2*V(Q01)+V(Q00)
XX1 N004 N001 N002 0 0 NC_06 N003 my_comparator
XX2 CLK N003 COMP_EN Q00 Q01 Q02 Q03 Q04 Q05 Sample SW0 SW0B SW1 SW1B SW2 SW2B SW3 SW3B SW4 SW4B SW5 SW5B mysarlogic

* block symbol definitions
.subckt my_comparator CLK VDD VINN VINP VSS VOUTN VOUTP
M2 N002 VINN N005 VSS CMOSN l={L2} w={W2} m={M2}
M3 N005 CLK VSS VSS CMOSN l={L3} w={W3} m={M3}
M4 N001 CLK VDD VDD CMOSP l={L4} w={W4} m={M4}
M5 N002 CLK VDD VDD CMOSP l={L5} w={W5} m={M5}
M1 N001 VINP N005 VSS CMOSN l={L1} w={W1} m={M1}
M6 VOUTP N001 VSS VSS CMOSN l={L6} w={W6} m={M6}
M7 VOUTP VOUTN VSS VSS CMOSN l={L7} w={W7} m={M7}
M8 N003 N001 VSS VSS CMOSN l={L8} w={W8} m={M8}
M9 VOUTP VOUTN N003 VDD CMOSP l={L9} w={W9} m={M9}
M10 N003 N001 VDD VDD CMOSP l={L10} w={W10} m={M10}
M11 VOUTN N002 VSS VSS CMOSN l={L11} w={W11} m={M11}
M12 VOUTN VOUTP VSS VSS CMOSN l={L12} w={W12} m={M12}
M13 N004 N002 VSS VSS CMOSN l={L13} w={W13} m={M13}
M14 VOUTN VOUTP N004 VDD CMOSP l={L14} w={W14} m={M14}
M15 N004 N002 VDD VDD CMOSP l={L15} w={W15} m={M15}
.param L = 0.18u
.param L1 = L
.param W1 = L1*10
.param M1 = 1
.param L2 = L
.param W2 = L2*10
.param M2 = 1
.param L3 = L
.param W3 = L3*10
.param M3 = 1
.param L4 = L
.param W4 = L4*10
.param M4 = 1
.param L5 = L
.param W5 = L5*10
.param M5 = 1
.param L6 = L
.param W6 = L6*10
.param M6 = 1
.param L7 = L
.param W7 = L7*10
.param M7 = 1
.param L8 = L
.param W8 = L8*10
.param M8 = 1
.param L9 = L
.param W9 = L9*10
.param M9 = 1
.param L10 = L
.param W10 = L10*10
.param M10 = 1
.param L11 = L
.param W11 = L11*10
.param M11 = 1
.param L12 = L
.param W12 = L12*10
.param M12 = 1
.param L13 = L
.param W13 = L13*10
.param M13 = 1
.param L14 = L
.param W14 = L14*10
.param M14 = 1
.param L15 = L
.param W15 = L15*10
.param M15 = 1
.include tsmc018.mdl
.ends my_comparator

.subckt mysarlogic CLK COMP_IN COMP_EN Q00 Q01 Q02 Q03 Q04 Q05 Sample SW0 SW0B SW1 SW1B SW2 SW2B SW3 SW3B SW4 SW4B SW5 SW5B
A1 TIHI 0 CLK 0 N007 N014 N021 0 DFLOP
A2 N021 0 CLK 0 N028 COMP_EN N022 0 DFLOP
A3 N022 0 CLK 0 N007 N015 N023 0 DFLOP
A4 N023 0 CLK 0 N007 N016 N024 0 DFLOP
A5 N024 0 CLK 0 N007 N017 N025 0 DFLOP
A6 N025 0 CLK 0 N007 N018 N026 0 DFLOP
A7 N026 0 CLK 0 N007 N019 N027 0 DFLOP
A8 N027 0 CLK 0 N007 N020 N028 0 DFLOP
A9 N028 0 N029 0 0 0 N007 0 DFLOP
A10 0 TIHI 0 N014 0 0 Sample 0 AND
A19 COMP_IN 0 N008 0 Sample 0 N001 0 DFLOP
A20 COMP_IN 0 N009 0 Sample 0 N002 0 DFLOP
A21 COMP_IN 0 N010 0 Sample 0 N003 0 DFLOP
A22 COMP_IN 0 N011 0 Sample 0 N004 0 DFLOP
A23 COMP_IN 0 N012 0 Sample 0 N005 0 DFLOP
A18 COMP_IN 0 N013 0 Sample 0 N006 0 DFLOP
A24 N001 0 N007 0 0 0 Q05 0 DFLOP
A25 N002 0 N007 0 0 0 Q04 0 DFLOP
A26 N003 0 N007 0 0 0 Q03 0 DFLOP
A27 N004 0 N007 0 0 0 Q02 0 DFLOP
A28 N005 0 N007 0 0 0 Q01 0 DFLOP
A29 N006 0 N007 0 0 0 Q00 0 DFLOP
A30 Sample D6 N001 0 0 SW5B SW5 0 OR
A11 0 N021 0 COMP_EN 0 0 N0V 0 AND
A12 0 N022 0 N015 0 N008 D6 0 AND
A13 0 N023 0 N016 0 N009 D5 0 AND
A14 0 N024 0 N017 0 N010 D4 0 AND
A15 0 N025 0 N018 0 N011 D3 0 AND
A16 0 N026 0 N019 0 N012 D2 0 AND
A17 0 N027 0 N020 0 N013 D1 0 AND
A31 Sample D5 N002 0 0 SW4B SW4 0 OR
A32 Sample D4 N003 0 0 SW3B SW3 0 OR
A33 Sample D3 N004 0 0 SW2B SW2 0 OR
A34 Sample D2 N005 0 0 SW1B SW1 0 OR
A35 Sample D1 N006 0 0 SW0B SW0 0 OR
V1 TIHI 0 1
A36 CLK 0 0 0 0 N029 0 0 BUF
.ends mysarlogic

.model NMOS NMOS
.model PMOS PMOS
.lib C:\Users\circuit\Documents\LTspiceXVII\lib\cmp\standard.mos
.tran 13u
.model SW SW(Ron=0.1 Roff=1G Vt=.5 Vh=-.4)
.meas tran reg1 find V(DOUT) AT=200n
.meas tran q0 find V(Q00) AT = 200n
.meas tran q1 find V(Q01) AT = 200n
.meas tran q2 find V(Q02) AT = 200n
.meas tran q3 find V(Q03) AT = 200n
.meas tran q4 find V(Q04) AT = 200n
.meas tran q5 find V(Q05) AT = 200n
.backanno
.end
